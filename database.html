<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ãƒ¡ã‚«ãƒ¡ã‚«ã»ã‚Šã»ã‚Š | åŒ–çŸ³å›³é‘‘</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #5D4037;
            --accent: #FFAB00; 
            --pop: #FF7043;
            --bg-color: #EFEBE9;
            --shelf-bg: #8D6E63;
            --shelf-shadow: #5D4037;
            --text-dark: #3E2723;
        }

        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#D7CCC8 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--text-dark);
            margin: 0; padding: 0; line-height: 1.8;
            padding-top: 60px;
            overflow-x: hidden;
        }

        .container { max-width: 800px; margin: 0 auto; padding: 20px 15px 80px; box-sizing: border-box; }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .site-header {
            position: fixed; top: 0; left: 0; width: 100%;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); z-index: 1000;
            padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box;
        }
        
        .header-logo { 
            display: flex; align-items: center; 
            text-decoration: none; cursor: pointer; 
        }
        .header-logo img {
            height: 36px;
            width: auto;
            margin-right: 8px;
        }
        .header-logo span {
            font-weight: 900; 
            color: var(--primary); 
            font-size: 1.1rem;
        }

        /* ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¨ãƒªã‚¢ */
        .hero-area { text-align: center; padding: 30px 0 20px; }
        .hero-copy {
            display: block; font-size: 1.5rem; font-weight: 900; color: var(--pop);
            margin-bottom: 20px; letter-spacing: 0.05em; text-shadow: 2px 2px 0 #fff;
            line-height: 1.4;
        }
        
        .hero-logo-box {
            display: inline-block; padding: 10px 30px; border-radius: 15px;
            background: #fff; box-shadow: 6px 6px 0 var(--accent);
            border: 4px solid var(--primary); transform: rotate(-2deg);
            margin-bottom: 15px;
        }
        .hero-logo-box h1 { margin: 0; font-size: 2.2rem; color: var(--primary); letter-spacing: 0.05em; line-height: 1.2; }

        /* æ£šã‚¨ãƒªã‚¢ */
        .shelf-container {
            background: var(--shelf-bg);
            padding: 15px;
            border-radius: 10px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.2), 0 10px 0 var(--shelf-shadow);
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }
        .shelf-container::before {
            content: "COLLECTION";
            position: absolute; top: -12px; left: 50%; transform: translateX(-50%);
            background: #4E342E; color: #fff; padding: 2px 15px; font-size: 0.8rem; border-radius: 10px; font-weight: bold;
            z-index: 5;
        }

        .collection-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px 10px;
        }

        .fossil-item {
            background: #fff;
            border-radius: 8px;
            aspect-ratio: 1 / 1;
            position: relative;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid #D7CCC8;
            transition: transform 0.2s;
            overflow: visible; 
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        @media (hover: hover) {
            .fossil-item:hover {
                transform: scale(1.05);
                z-index: 100;
                border-color: var(--pop);
            }
        }
        .fossil-item:active { transform: scale(0.95); }

        .fossil-item.locked { background: #ECEFF1; }
        .fossil-item.locked img {
            filter: brightness(0) opacity(0.2);
            transform: scale(0.8);
        }
        .fossil-item.locked::after {
            content: "?"; position: absolute; font-size: 2rem;
            color: rgba(0,0,0,0.1); font-weight: 900;
            pointer-events: none;
        }

        .fossil-item.unlocked {
            border-color: var(--accent);
            background: #FFF8E1;
        }
        .fossil-item.unlocked img {
            animation: pukaPuka 3s ease-in-out infinite;
        }
        
        .fossil-item.selected {
            border-color: var(--pop);
            box-shadow: 0 0 0 4px rgba(255, 112, 67, 0.3);
            background: #fff;
        }

        .fossil-item.coming-soon { background: #D7CCC8; cursor: default; }
        .coming-text { font-size: 0.7rem; font-weight: bold; color: #fff; text-align: center; opacity: 0.7; }
        .fossil-img { width: 70%; height: 70%; object-fit: contain; position: relative; z-index: 1; }

        @keyframes pukaPuka {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-5px) scale(1.05); }
        }

        @keyframes flashEffect {
            0% { background-color: #fff; box-shadow: 0 0 50px #fff; }
            100% { background-color: #FFF8E1; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        }
        .just-unlocked { animation: flashEffect 0.6s ease-out forwards; }

        /* ã‚­ãƒ©ã‚­ãƒ© */
        .sparkle-particle {
            position: absolute; top: 50%; left: 50%; width: 15px; height: 15px;
            background: radial-gradient(circle, #fff 20%, #FFD700 100%);
            border-radius: 50%; pointer-events: none; z-index: 999;
            transform: translate(-50%, -50%) scale(0); opacity: 0;
            animation: sparkleFly 0.8s ease-out forwards;
        }
        @keyframes sparkleFly {
            0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 1; }
            50% { opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(1.5) rotate(180deg); opacity: 0; }
        }

        /* ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ— */
        .tooltip-box {
            position: absolute; bottom: 105%; left: 50%; transform: translateX(-50%) scale(0.8);
            opacity: 0; pointer-events: none;
            background: rgba(255, 255, 255, 0.98); color: #333;
            padding: 8px; border-radius: 8px; width: 140px; text-align: center;
            font-size: 0.75rem; font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: 3px solid var(--pop);
            z-index: 200; transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); transform-origin: center bottom;
        }
        .tooltip-box::after {
            content: ""; position: absolute; top: 100%; left: 50%; margin-left: -8px;
            border-width: 8px; border-style: solid; border-color: var(--pop) transparent transparent transparent;
        }
        .fossil-item:hover .tooltip-box { transform: translateX(-50%) scale(1); opacity: 1; bottom: 110%; }


        /* --- è©³ç´°ã‚¨ãƒªã‚¢ --- */
        .detail-section {
            display: none;
            margin-top: 30px;
            background: #fff;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border: 4px solid var(--primary);
            animation: slideUp 0.5s ease-out;
            text-align: center;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .detail-title {
            font-size: 1.8rem; margin: 0 0 20px; color: var(--primary);
            border-bottom: 2px dashed #D7CCC8; padding-bottom: 10px;
        }
        .detail-image-box {
            background: #FFF8E1; border-radius: 10px; padding: 20px;
            display: inline-block; margin-bottom: 20px;
            border: 2px solid var(--accent);
        }
        .detail-img-large {
            max-width: 100%; height: auto; max-height: 200px;
            filter: drop-shadow(0 4px 0 rgba(0,0,0,0.1));
            animation: pukaPuka 4s ease-in-out infinite;
        }

        .detail-table {
            width: 100%; border-collapse: collapse; margin-bottom: 20px;
            font-size: 0.9rem;
        }
        .detail-table th {
            background: var(--primary); color: #fff; padding: 8px;
            border: 1px solid var(--primary); width: 30%;
        }
        .detail-table td {
            background: #fff; padding: 8px; border: 1px solid #D7CCC8;
            color: var(--text-dark); font-weight: bold;
        }

        .detail-desc-text {
            text-align: left; background: #EFEBE9; padding: 15px;
            border-radius: 8px; font-size: 0.9rem; line-height: 1.8;
            border-left: 5px solid var(--pop);
        }

        /* --- UIãƒ‘ãƒ¼ãƒ„ --- */
        .scroll-top-btn {
            position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px;
            background: var(--pop); color: #fff; border: none; border-radius: 50%;
            font-size: 1.5rem; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            cursor: pointer; z-index: 900; display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s, transform 0.2s;
        }
        .scroll-top-btn.show { opacity: 1; pointer-events: auto; }
        .scroll-top-btn:active { transform: scale(0.9); }

        /* --- ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦åŒ–ï¼‰ --- */
        .debug-area {
            display: none; 
            /* ç”»é¢ã«å›ºå®šã—ã¦æµ®ã‹ã›ã‚‹ */
            position: fixed; 
            bottom: 20px; 
            left: 20px; 
            width: 320px;
            
            text-align: center; padding: 0; /* paddingã¯å†…éƒ¨ã‚³ãƒ³ãƒ†ãƒŠã§èª¿æ•´ */
            background: #fff; border: 2px solid #546E7A; border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 3000; /* ä»–ã®è¦ç´ ã‚ˆã‚Šæ‰‹å‰ã« */
            overflow: hidden;
        }
        
        /* æŒã¡æ‰‹ï¼ˆãƒãƒ³ãƒ‰ãƒ«ï¼‰éƒ¨åˆ† */
        .debug-header {
            background: #546E7A;
            color: #fff;
            padding: 8px;
            cursor: move; /* ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç§»å‹•ãƒãƒ¼ã‚¯ã« */
            font-weight: bold;
            font-size: 0.9rem;
            user-select: none; /* æ–‡å­—é¸æŠé˜²æ­¢ */
        }

        .debug-content {
            padding: 15px;
        }

        .debug-btn { 
            margin: 3px; padding: 6px 10px; border: none; background: #78909C; color: #fff; border-radius: 5px; cursor: pointer; font-size: 0.8rem;
        }
        .debug-reset { background: #E65100; font-weight:bold; width: 100%; margin: 5px 0; }
        .debug-close { background: #d32f2f; margin-top: 10px; width: 100%; }

        .toast {
            position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7); color: white; padding: 8px 16px; border-radius: 20px;
            font-size: 0.85rem; z-index: 4000; opacity: 0; transition: opacity 0.3s; pointer-events: none;
        }
        .toast.show { opacity: 1; }

        footer { background: #4E342E; color: #D7CCC8; padding: 20px; text-align: center; font-size: 0.7rem; margin-top: 40px; }
    </style>
</head>
<body>

<header class="site-header">
    <a href="#" class="header-logo" id="top-logo">
        <img src="images/lab.png" alt="ãƒ©ãƒœã®ã‚¢ã‚¤ã‚³ãƒ³">
        <span>ãƒ¡ã‚«ãƒ¡ã‚«ã»ã‚Šã»ã‚Š</span>
    </a>
</header>

<div class="container">
    <div class="hero-area">
        <div class="hero-logo-box"><h1>åŒ–çŸ³å›³é‘‘</h1></div><br>
        <span class="hero-copy">æ˜ã‚Šå‡ºã›ï¼æœªæ¥ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ï¼</span>
        <span class="concept">ã™ã¹ã¦ã®åŒ–çŸ³ã‚’é›†ã‚ã‚ˆã†ï¼</span>
    </div>

    <div class="shelf-container">
        <div class="collection-grid" id="grid-container"></div>
    </div>

    <div id="detail-section" class="detail-section">
        <h2 id="dino-info-name" class="detail-title">æç«œã®åå‰</h2>
        
        <div class="detail-image-box">
            <img id="dino-info-img" src="" class="detail-img-large" alt="">
        </div>

        <table class="detail-table">
            <tr>
                <th>åå‰ã®ç”±æ¥</th>
                <td id="dino-info-name-origin">-</td>
            </tr>
            <tr>
                <th>å¤§ãã•</th>
                <td id="dino-info-size">-</td>
            </tr>
            <tr>
                <th>é‡ã•</th>
                <td id="dino-info-weight">-</td>
            </tr>
            <tr>
                <th>åˆ†é¡</th>
                <td id="dino-info-class">-</td>
            </tr>
            <tr>
                <th>æ™‚ä»£</th>
                <td id="dino-info-era">-</td>
            </tr>
            <tr>
                <th>ç”£å‡ºå›½</th>
                <td id="dino-info-origin">-</td>
            </tr>
        </table>

        <div id="dino-info-desc" class="detail-desc-text">
            ã“ã“ã«è©³ã—ã„èª¬æ˜ãŒå…¥ã‚Šã¾ã™ã€‚
        </div>
    </div>

    <div class="debug-area" id="debug-section">
        <div class="debug-header" id="debug-drag-handle">ğŸ›  é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ (Move Me)</div>
        
        <div class="debug-content">
            <div style="margin-bottom:5px;">
                <button class="debug-btn" onclick="simulateNFC('ammonite')">ã‚¢ãƒ³ãƒ¢</button>
                <button class="debug-btn" onclick="simulateNFC('trilobite')">ä¸‰è‘‰è™«</button>
                <button class="debug-btn" onclick="simulateNFC('spino')">ã‚¹ãƒ”ãƒ</button>
                <button class="debug-btn" onclick="simulateNFC('fukuiraptor')">ãƒ•ã‚¯ã‚¤</button>
                <button class="debug-btn" onclick="simulateNFC('trex')">ãƒ†ã‚£ãƒ©ãƒ</button>
            </div>
            <button class="debug-btn debug-reset" onclick="resetCollection()">â†» å›³é‘‘ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
            <button class="debug-btn debug-close" onclick="disableDebugMode()">çµ‚äº†ã™ã‚‹</button>
        </div>
    </div>
</div>

<div id="toast" class="toast"></div>
<button id="scroll-top-btn" class="scroll-top-btn">â–²</button>

<footer>
    <span id="copyright-trigger" style="user-select: none;">Â© 2026 MECHAMECHA HORIHORI</span>
</footer>

<audio id="sfx-sparkle" src="sparkle.mp3" preload="auto"></audio>

<script>
    const fossils = [
        { 
            id: 'ammonite', name: 'ã‚¢ãƒ³ãƒ¢ãƒŠã‚¤ãƒˆ', img: 'images/ammonite.jpg', 
            hint: 'ãã‚‹ãã‚‹ã—ã¦ã„ã‚‹â€¦<br>æµ·ã«ã„ãŸã‚‰ã—ã„', 
            desc: 'ã€ã‚¢ãƒ³ãƒ¢ãƒŠã‚¤ãƒˆã€‘<br>ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã‚’è¦‹ã‚‹',
            data: {
                nameOrigin: 'ã‚¢ãƒ¢ãƒ³ï¼ˆã‚¨ã‚¸ãƒ—ãƒˆã®ç¥ï¼‰ã®è§’',
                size: 'æ•°cm ã€œ 2m',
                weight: 'æ•°g ã€œ æ•°åkg',
                class: 'é ­è¶³é¡ï¼ˆã‚¤ã‚«ãƒ»ã‚¿ã‚³ã®ä»²é–“ï¼‰',
                era: 'ãƒ‡ãƒœãƒ³ç´€ ã€œ ç™½äºœç´€',
                origin: 'ä¸–ç•Œä¸­',
                longDesc: 'æ¸¦å·»ãçŠ¶ã®æ®»ã‚’æŒã£ã¦ã„ãŸæµ·ã®ç”Ÿãç‰©ã ã‚ˆã€‚æç«œãŒç”Ÿãã¦ã„ãŸæ™‚ä»£ã‚ˆã‚Šãšã£ã¨å‰ã‹ã‚‰ã€æç«œãŒã„ãªããªã‚‹ã¾ã§ã€é•·ã„é–“ä¸–ç•Œä¸­ã®æµ·ã§ç¹æ „ã—ã¦ã„ãŸã‚“ã ã€‚æ®»ã®ä¸­ã«ã‚¬ã‚¹ã‚„æ°´ã‚’å…¥ã‚Œã¦ã€æµ·ã®ä¸­ã‚’ãƒ•ãƒ¯ãƒ•ãƒ¯ã¨æ¼‚ã£ã¦ã„ãŸã¨è€ƒãˆã‚‰ã‚Œã¦ã„ã‚‹ã‚ˆã€‚'
            }
        },
        { 
            id: 'spino', name: 'ã‚¹ãƒ”ãƒã‚µã‚¦ãƒ«ã‚¹', img: 'images/spinosaurus.jpg',
            hint: 'æ°´è¾ºã§æš®ã‚‰ã—ã¦ã„ãŸ<br>æç«œã®æ­¯â€¦ï¼Ÿ', 
            desc: 'ã€ã‚¹ãƒ”ãƒã‚µã‚¦ãƒ«ã‚¹ã€‘<br>ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã‚’è¦‹ã‚‹',
            data: {
                nameOrigin: 'ãƒˆã‚²ãƒˆã‚²ã®ãƒˆã‚«ã‚²',
                size: 'å…¨é•· 10 ã€œ 18m',
                weight: '6 ã€œ 9ãƒˆãƒ³',
                class: 'ç£è„šé¡ï¼ˆè‚‰é£Ÿæç«œï¼‰',
                era: 'ç™½äºœç´€ï¼ˆå‰æœŸï¼‰',
                origin: 'ã‚¨ã‚¸ãƒ—ãƒˆã€ãƒ¢ãƒ­ãƒƒã‚³',
                longDesc: 'èƒŒä¸­ã«ã‚ã‚‹å¤§ããªã€Œå¸†ã€ãŒç‰¹å¾´çš„ãªå·¨å¤§ãªè‚‰é£Ÿæç«œã ã‚ˆã€‚ãƒ¯ãƒ‹ã®ã‚ˆã†ã«å£ãŒç´°é•·ãã€æ°´è¾ºã§é­šã‚’æ•ã¾ãˆã¦é£Ÿã¹ã¦ã„ãŸã¨è€ƒãˆã‚‰ã‚Œã¦ã„ã‚‹ã‚“ã ã€‚å²ä¸Šæœ€å¤§ç´šã®è‚‰é£Ÿæç«œã®ã²ã¨ã¤ã ã¨è¨€ã‚ã‚Œã¦ã„ã‚‹ã‚ˆï¼'
            }
        },
        { 
            id: 'trex', name: 'ãƒ†ã‚£ãƒ©ãƒã‚µã‚¦ãƒ«ã‚¹', img: 'images/tyrannosaurus.jpg',
            hint: 'æœ€å¼·ã®æç«œã®<br>ã‚­ãƒã‹ã‚‚ã—ã‚Œãªã„â€¦', 
            desc: 'ã€ãƒ†ã‚£ãƒ©ãƒã‚µã‚¦ãƒ«ã‚¹ã€‘<br>ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã‚’è¦‹ã‚‹',
            data: {
                nameOrigin: 'æš´å›ãƒˆã‚«ã‚²ã®ç‹',
                size: 'å…¨é•· ç´„13m',
                weight: '6 ã€œ 9ãƒˆãƒ³',
                class: 'ç£è„šé¡ï¼ˆè‚‰é£Ÿæç«œï¼‰',
                era: 'ç™½äºœç´€ï¼ˆå¾ŒæœŸï¼‰',
                origin: 'ã‚¢ãƒ¡ãƒªã‚«ã€ã‚«ãƒŠãƒ€',
                longDesc: 'ã€Œæš´å›ãƒˆã‚«ã‚²ã®ç‹ã€ã¨ã„ã†æ„å‘³ã®åå‰ã‚’æŒã¤ã€ã‚‚ã£ã¨ã‚‚æœ‰åãªæç«œã ã­ã€‚å¤ªãã¦é•·ã„æ­¯ã¨ã€ã¨ã¦ã¤ã‚‚ãªãå¼·ã„ã‚¢ã‚´ã®åŠ›ã§ã€ç²ç‰©ã®éª¨ã¾ã§å™›ã¿ç •ã„ã¦ã—ã¾ã£ãŸã¨è¨€ã‚ã‚Œã¦ã„ã‚‹ã‚ˆã€‚å—…è¦šã‚‚ã¨ã¦ã‚‚å„ªã‚Œã¦ã„ãŸã‚“ã ã€‚'
            }
        },
        { 
            id: 'trilobite', name: 'ä¸‰è‘‰è™«', img: 'images/trilobite.jpg', 
            hint: 'æµ·ã®åº•ã‚’<br>ã¯ã£ã¦ã„ãŸã‚‰ã—ã„â€¦', 
            desc: 'ã€ä¸‰è‘‰è™«ã€‘<br>ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã‚’è¦‹ã‚‹',
            data: {
                nameOrigin: '3ã¤ã®è‘‰ï¼ˆã¾ãŸï¼‰',
                size: 'æ•°mm ã€œ 70cm',
                weight: 'ã¨ã£ã¦ã‚‚è»½ã„',
                class: 'ç¯€è¶³å‹•ç‰©',
                era: 'ã‚«ãƒ³ãƒ–ãƒªã‚¢ç´€ ã€œ ãƒšãƒ«ãƒ ç´€',
                origin: 'ä¸–ç•Œä¸­',
                longDesc: 'ä»Šã®ãƒ€ãƒ³ã‚´ãƒ ã‚·ã‚„ã‚¨ãƒ“ã®é ã„è¦ªæˆšã ã‚ˆã€‚ä½“ãŒã€Œå·¦ãƒ»çœŸã‚“ä¸­ãƒ»å³ã€ã®3ã¤ã®éƒ¨åˆ†ã«åˆ†ã‹ã‚Œã¦ã„ã‚‹ã‹ã‚‰ã€Œä¸‰è‘‰è™«ã€ã¨å‘¼ã°ã‚Œã‚‹ã‚“ã ã€‚æç«œãŒç”Ÿã¾ã‚Œã‚‹ã‚ˆã‚Šã‚‚ãšã£ã¨æ˜”ã®æµ·ã§ã€å¤§ç¹æ „ã—ã¦ã„ãŸç”Ÿãç‰©ã ã‚ˆã€‚'
            }
        },
        { 
            id: 'fukuiraptor', name: 'ãƒ•ã‚¯ã‚¤ãƒ©ãƒ—ãƒˆãƒ«', img: 'images/fukuiraptor.jpg',
            hint: 'æ—¥æœ¬ã§è¦‹ã¤ã‹ã£ãŸ<br>è‚‰é£Ÿæç«œã®ãƒ„ãƒ¡â€¦ï¼Ÿ', 
            desc: 'ã€ãƒ•ã‚¯ã‚¤ãƒ©ãƒ—ãƒˆãƒ«ã€‘<br>ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã‚’è¦‹ã‚‹',
            data: {
                nameOrigin: 'ç¦äº•ã®æ³¥æ£’',
                size: 'å…¨é•· 4.2m',
                weight: 'ç´„300kg',
                class: 'ç£è„šé¡ï¼ˆãƒ¡ã‚¬ãƒ©ãƒ—ãƒˆãƒ«é¡ã¨è€ƒãˆã‚‰ã‚Œã¦ã„ã‚‹ï¼‰',
                era: 'ç™½äºœç´€ï¼ˆå‰æœŸï¼‰',
                origin: 'æ—¥æœ¬ï¼ˆç¦äº•çœŒï¼‰',
                longDesc: 'æ—¥æœ¬ã®ç¦äº•çœŒå‹å±±å¸‚ã§ç™ºè¦‹ã•ã‚ŒãŸè‚‰é£Ÿæç«œã ã‚ˆï¼å¤§ããªæ‰‹ã®çˆªãŒç‰¹å¾´ãªã‚“ã ã€‚ã“ã‚Œã‚’ä½¿ã£ã¦ç²ç‰©ã‚’æ•ã¾ãˆã¦ã„ãŸã¨è€ƒãˆã‚‰ã‚Œã¦ã„ã‚‹ã‚ˆã€‚æ—¥æœ¬ã«ã‚‚ã“ã‚“ãªã«ã‹ã£ã“ã„ã„æç«œãŒã„ãŸãªã‚“ã¦ã™ã”ã„ã­ï¼'
            }
        },
        { id: 'coming1', type: 'coming_soon' },
        { id: 'coming2', type: 'coming_soon' },
        { id: 'coming3', type: 'coming_soon' },
        { id: 'coming4', type: 'coming_soon' }
    ];

    let unlockedStatus = { ammonite: false, spino: false, trex: false, trilobite: false, fukuiraptor: false };

    // ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
    const savedData = localStorage.getItem('mechMechCollection');
    if (savedData) {
        try { unlockedStatus = JSON.parse(savedData); } catch(e) {}
    }
    function saveStatus() {
        localStorage.setItem('mechMechCollection', JSON.stringify(unlockedStatus));
    }

    // --- åˆæœŸåŒ–å‡¦ç† ---
    const gridContainer = document.getElementById('grid-container');
    const detailSection = document.getElementById('detail-section');

    fossils.forEach(f => {
        const div = document.createElement('div');
        div.className = 'fossil-item';
        div.id = `item-${f.id}`;
        
        if (f.type === 'coming_soon') {
            div.classList.add('coming-soon');
            div.innerHTML = '<div class="coming-text">COMING<br>SOON<br>...</div>';
        } else {
            if (unlockedStatus[f.id]) {
                div.classList.add('unlocked');
                div.classList.remove('locked');
                div.innerHTML = `<img src="${f.img}" class="fossil-img" alt="${f.name}"><div class="tooltip-box" id="tooltip-${f.id}">${f.desc}</div>`;
            } else {
                div.classList.add('locked');
                div.classList.remove('unlocked');
                div.innerHTML = `<img src="${f.img}" class="fossil-img" alt="${f.name}"><div class="tooltip-box" id="tooltip-${f.id}">${f.hint}</div>`;
            }
            
            div.addEventListener('click', () => {
                if (unlockedStatus[f.id]) {
                    showDetails(f.id);
                } else {
                    div.style.transform = "translateX(5px)";
                    setTimeout(() => div.style.transform = "none", 100);
                }
            });
        }
        gridContainer.appendChild(div);
    });

    /**
     * UIæ“ä½œ
     */
    function showDetails(id) {
        const data = fossils.find(f => f.id === id);
        if (!data) return;

        document.querySelectorAll('.fossil-item').forEach(el => el.classList.remove('selected'));
        document.getElementById(`item-${id}`).classList.add('selected');

        document.getElementById('dino-info-name').textContent = data.name;
        
        const imgEl = document.getElementById('dino-info-img');
        imgEl.src = data.img;
        imgEl.alt = data.name;
        
        document.getElementById('dino-info-name-origin').textContent = data.data.nameOrigin;
        document.getElementById('dino-info-size').textContent = data.data.size;
        document.getElementById('dino-info-weight').textContent = data.data.weight;
        document.getElementById('dino-info-class').textContent = data.data.class;
        document.getElementById('dino-info-era').textContent = data.data.era;
        document.getElementById('dino-info-origin').textContent = data.data.origin;
        
        document.getElementById('dino-info-desc').textContent = data.data.longDesc;

        detailSection.style.display = 'block';
        setTimeout(() => {
            detailSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
    }

    // ã‚¹ãƒ ãƒ¼ã‚ºã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    const scrollTopBtn = document.getElementById('scroll-top-btn');
    const topLogo = document.getElementById('top-logo');

    window.addEventListener('scroll', () => {
        if (window.scrollY > 200) { scrollTopBtn.classList.add('show'); }
        else { scrollTopBtn.classList.remove('show'); }
    });
    
    function scrollToTop(e) {
        e.preventDefault();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    if(scrollTopBtn) scrollTopBtn.addEventListener('click', scrollToTop);
    if(topLogo) topLogo.addEventListener('click', scrollToTop);

    /**
     * ãƒ‡ãƒãƒƒã‚°ãƒ»é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ (ãƒ‰ãƒ©ãƒƒã‚°æ©Ÿèƒ½ä»˜ã)
     */
    let tapCount = 0;
    let tapTimer;
    const COPYRIGHT_TRIGGER = document.getElementById('copyright-trigger');
    const DEBUG_SECTION = document.getElementById('debug-section');
    const DEBUG_HANDLE = document.getElementById('debug-drag-handle');

    if (localStorage.getItem('debugEnabled') === 'true') {
        DEBUG_SECTION.style.display = 'block';
    }

    // ã‚³ãƒ”ãƒ¼ãƒ©ã‚¤ãƒˆ7å›ã‚¿ãƒƒãƒ—ã§èµ·å‹•
    COPYRIGHT_TRIGGER.addEventListener('click', () => {
        tapCount++;
        clearTimeout(tapTimer);
        tapTimer = setTimeout(() => { tapCount = 0; }, 2000);
        const remaining = 7 - tapCount;
        if (remaining > 0 && remaining <= 5) {
            showToast(`é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ã¾ã§ã‚ã¨ ${remaining} å›ã§ã™`);
        }
        if (tapCount >= 7) {
            enableDebugMode();
            tapCount = 0;
        }
    });

    function enableDebugMode() {
        DEBUG_SECTION.style.display = 'block';
        localStorage.setItem('debugEnabled', 'true');
        showToast('é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã—ãŸï¼');
    }
    
    function disableDebugMode() {
        DEBUG_SECTION.style.display = 'none';
        localStorage.removeItem('debugEnabled');
        showToast('é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ã‚’çµ‚äº†ã—ã¾ã—ãŸ');
    }

    // --- ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•å‡¦ç† ---
    let isDragging = false;
    let currentX;
    let currentY;
    let initialX;
    let initialY;
    let xOffset = 0;
    let yOffset = 0;

    DEBUG_HANDLE.addEventListener("mousedown", dragStart);
    document.addEventListener("mouseup", dragEnd);
    document.addEventListener("mousemove", drag);

    // ã‚¹ãƒãƒ›å¯¾å¿œï¼ˆã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆï¼‰
    DEBUG_HANDLE.addEventListener("touchstart", dragStart, {passive: false});
    document.addEventListener("touchend", dragEnd);
    document.addEventListener("touchmove", drag, {passive: false});

    function dragStart(e) {
        if (e.type === "touchstart") {
            initialX = e.touches[0].clientX - xOffset;
            initialY = e.touches[0].clientY - yOffset;
        } else {
            initialX = e.clientX - xOffset;
            initialY = e.clientY - yOffset;
        }

        if (e.target === DEBUG_HANDLE) {
            isDragging = true;
        }
    }

    function dragEnd(e) {
        initialX = currentX;
        initialY = currentY;
        isDragging = false;
    }

    function drag(e) {
        if (isDragging) {
            e.preventDefault();
            if (e.type === "touchmove") {
                currentX = e.touches[0].clientX - initialX;
                currentY = e.touches[0].clientY - initialY;
            } else {
                currentX = e.clientX - initialX;
                currentY = e.clientY - initialY;
            }

            xOffset = currentX;
            yOffset = currentY;

            setTranslate(currentX, currentY, DEBUG_SECTION);
        }
    }

    function setTranslate(xPos, yPos, el) {
        el.style.transform = `translate3d(${xPos}px, ${yPos}px, 0)`;
    }

    // --- ãã®ä»–æ©Ÿèƒ½ ---
    function resetCollection() {
        Object.keys(unlockedStatus).forEach(key => unlockedStatus[key] = false);
        localStorage.removeItem('mechMechCollection');
        fossils.forEach(f => {
            if (f.type === 'coming_soon') return;
            const item = document.getElementById(`item-${f.id}`);
            const tooltip = document.getElementById(`tooltip-${f.id}`);
            item.classList.add('locked');
            item.classList.remove('unlocked', 'just-unlocked', 'selected');
            tooltip.innerHTML = f.hint; 
        });
        detailSection.style.display = 'none';
        showToast('å›³é‘‘ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
    }
    
    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.innerText = message;
        toast.classList.add('show');
        setTimeout(() => { toast.classList.remove('show'); }, 2000);
    }

    function simulateNFC(id) {
        if (!fossils.find(f => f.id === id) || unlockedStatus[id]) return;
        unlockFossilEffect(id);
    }

    function unlockFossilEffect(id) {
        const item = document.getElementById(`item-${id}`);
        const data = fossils.find(f => f.id === id);
        
        const audio = document.getElementById('sfx-sparkle');
        if(audio) { 
            audio.currentTime = 0; audio.volume = 1.0;
            audio.play().catch(e => {});
        }

        unlockedStatus[id] = true;
        saveStatus();

        document.getElementById(`tooltip-${id}`).innerHTML = data.desc;
        
        item.classList.remove('locked');
        item.classList.add('unlocked', 'just-unlocked');
        setTimeout(() => item.classList.remove('just-unlocked'), 600);
        createSparkles(item);
    }

    function createSparkles(element) {
        for(let i=0; i<20; i++) {
            const sparkle = document.createElement('div');
            sparkle.classList.add('sparkle-particle');
            const angle = Math.random() * 360; 
            const distance = 60 + Math.random() * 80;
            const tx = Math.cos(angle * Math.PI / 180) * distance + 'px';
            const ty = Math.sin(angle * Math.PI / 180) * distance + 'px';
            sparkle.style.setProperty('--tx', tx);
            sparkle.style.setProperty('--ty', ty);
            sparkle.style.animationDelay = (Math.random() * 0.2) + 's';
            element.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 1000);
        }
    }
</script>

</body>
</html>